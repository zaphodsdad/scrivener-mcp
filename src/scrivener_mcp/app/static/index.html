<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrivener Web App</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <h1>Scrivener</h1>
            <div class="header-controls">
                <span id="project-name">No project loaded</span>
                <span id="lock-status"></span>
                <button id="btn-open-project" class="btn">Open Project</button>
                <button id="btn-settings" class="btn btn-icon">&#9881;</button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main">
            <!-- Binder Sidebar -->
            <aside class="binder">
                <div class="binder-header">
                    <h2>Binder</h2>
                    <input type="text" id="binder-search" placeholder="Search..." class="search-input">
                </div>
                <div id="binder-tree" class="binder-tree">
                    <p class="placeholder">Open a project to see the binder</p>
                </div>
            </aside>

            <!-- Editor Panel -->
            <main class="editor-panel">
                <div class="editor-header">
                    <h2 id="doc-title">Select a document</h2>
                    <div class="editor-meta">
                        <span id="doc-words">0 words</span>
                        <span id="doc-path"></span>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab active" data-tab="content">Content</button>
                    <button class="tab" data-tab="synopsis">Synopsis</button>
                    <button class="tab" data-tab="notes">Notes</button>
                </div>

                <!-- Tab Content -->
                <div class="tab-content active" id="tab-content">
                    <textarea id="editor-content" placeholder="Document content will appear here..."></textarea>
                    <div class="editor-actions">
                        <button id="btn-save-content" class="btn btn-primary" disabled>Save Changes</button>
                        <button id="btn-send-to-ai" class="btn">Send to AI</button>
                    </div>
                </div>

                <div class="tab-content" id="tab-synopsis">
                    <textarea id="editor-synopsis" placeholder="Synopsis (index card text)..."></textarea>
                    <div class="editor-actions">
                        <button id="btn-save-synopsis" class="btn btn-primary" disabled>Save Synopsis</button>
                    </div>
                </div>

                <div class="tab-content" id="tab-notes">
                    <textarea id="editor-notes" placeholder="Inspector notes..."></textarea>
                    <div class="editor-actions">
                        <button id="btn-save-notes" class="btn btn-primary" disabled>Save Notes</button>
                    </div>
                </div>
            </main>

            <!-- AI Chat Panel -->
            <aside class="chat-panel">
                <div class="chat-header">
                    <h2>AI Assistant</h2>
                    <span id="llm-model">Not configured</span>
                </div>
                <div id="chat-messages" class="chat-messages">
                    <div class="chat-message system">
                        Configure your API key in settings to start chatting.
                    </div>
                </div>
                <div class="chat-input-container">
                    <textarea id="chat-input" placeholder="Ask about your manuscript..." rows="3"></textarea>
                    <button id="btn-send-chat" class="btn btn-primary">Send</button>
                </div>
            </aside>
        </div>
    </div>

    <!-- Project Picker Modal -->
    <div id="modal-projects" class="modal">
        <div class="modal-content modal-wide">
            <h2>Open Project</h2>

            <!-- Tabs for different browse modes -->
            <div class="modal-tabs">
                <button class="modal-tab active" data-modal-tab="recent">Recent Projects</button>
                <button class="modal-tab" data-modal-tab="browse">Browse Files</button>
            </div>

            <!-- Recent Projects Tab -->
            <div id="modal-tab-recent" class="modal-tab-content active">
                <div id="project-list" class="project-list">
                    <p>Searching for projects...</p>
                </div>
            </div>

            <!-- Browse Files Tab -->
            <div id="modal-tab-browse" class="modal-tab-content">
                <div class="browse-header">
                    <button id="btn-browse-up" class="btn btn-small">â†‘ Up</button>
                    <span id="browse-path">/</span>
                </div>
                <div id="browse-list" class="browse-list">
                    <p>Loading...</p>
                </div>
            </div>

            <div class="modal-actions">
                <input type="text" id="custom-path" placeholder="Or paste path to .scriv folder">
                <button id="btn-open-custom" class="btn">Open</button>
                <button id="btn-close-modal" class="btn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="modal-settings" class="modal">
        <div class="modal-content modal-wide">
            <h2>LLM Settings</h2>
            <div class="settings-form">
                <label>
                    Provider:
                    <select id="setting-provider">
                        <option value="openrouter">OpenRouter (Multiple AIs)</option>
                        <option value="anthropic">Anthropic (Direct)</option>
                        <option value="openai">OpenAI (Direct)</option>
                        <option value="ollama">Ollama (Local)</option>
                        <option value="custom">Custom API</option>
                    </select>
                </label>

                <label>
                    API Key:
                    <input type="password" id="setting-api-key" placeholder="Enter API key">
                    <small id="api-key-hint" class="hint">Required for cloud providers</small>
                </label>

                <label id="base-url-group" style="display: none;">
                    Base URL:
                    <input type="text" id="setting-base-url" placeholder="http://localhost:11434/v1">
                    <small class="hint">For Ollama or custom endpoints</small>
                </label>

                <label>
                    Model:
                    <select id="setting-model-select">
                        <option value="">-- Select a model --</option>
                    </select>
                </label>

                <label>
                    Or enter model manually:
                    <input type="text" id="setting-model-custom" placeholder="e.g., anthropic/claude-sonnet-4-20250514">
                    <small class="hint">For models not in the list</small>
                </label>
            </div>
            <div class="modal-actions">
                <button id="btn-save-settings" class="btn btn-primary">Save</button>
                <button id="btn-close-settings" class="btn">Cancel</button>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
